package drawio

import (
	_ "embed"
	"fmt"
	"os"
	"text/template"
)

//go:embed connectivityMap.drawio.tmpl
var drawioTemplate string

type drawioData struct {
	IconSize   int
	FipXOffset int
	FipYOffset int
	VSIXOffset int
	VSIYOffset int
	VSISize    int
	ShowNIIcon bool
	Nodes      []TreeNodeInterface
}

func (data *drawioData) FIPStyle() string {
	return "shape=image;aspect=fixed;image=data:image/svg+xml,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OSA0OSI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMxMTkyZTg7fS5jbHMtMntmaWxsOiNmZmY7fS5jbHMtM3tmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iMC41IiB5PSIwLjkyIiB3aWR0aD0iNDgiIGhlaWdodD0iNDcuMTYiIHJ4PSI4Ii8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNMzAuMTIsMjEuNDNhMy4xMywzLjEzLDAsMCwwLTMuMDYsMi40NkgyMS45NGEzLjA3LDMuMDcsMCwxLDAsMCwxLjIyaDUuMTJhMy4xMiwzLjEyLDAsMSwwLDMuMDYtMy42OFptMCw0LjkxQTEuODQsMS44NCwwLDEsMSwzMiwyNC41LDEuODUsMS44NSwwLDAsMSwzMC4xMiwyNi4zNFoiLz48cmVjdCBjbGFzcz0iY2xzLTMiIHg9IjE0LjUiIHk9IjE0LjY3IiB3aWR0aD0iMjAiIGhlaWdodD0iMTkuNjUiLz48L3N2Zz4=;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;spacingTop=-7;"
}
func (data *drawioData) VsiStyle() string {
	return "shape=image;aspect=fixed;image=data:image/svg+xml,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OSA0OSI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMxOTgwMzg7fS5jbHMtMntmaWxsOiNmZmY7fS5jbHMtM3tmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIvPjxjaXJjbGUgY2xhc3M9ImNscy0yIiBjeD0iMTguODgiIGN5PSIyOC44OCIgcj0iMC42MyIvPjxyZWN0IGNsYXNzPSJjbHMtMiIgeD0iMTUuNzUiIHk9IjE4LjI1IiB3aWR0aD0iMi41IiBoZWlnaHQ9IjEuMjUiLz48cmVjdCBjbGFzcz0iY2xzLTIiIHg9IjE5LjUiIHk9IjE4LjI1IiB3aWR0aD0iMi41IiBoZWlnaHQ9IjEuMjUiLz48cmVjdCBjbGFzcz0iY2xzLTIiIHg9IjIzLjI1IiB5PSIxOC4yNSIgd2lkdGg9IjIuNSIgaGVpZ2h0PSIxLjI1Ii8+PHJlY3QgY2xhc3M9ImNscy0yIiB4PSIyNyIgeT0iMTguMjUiIHdpZHRoPSIyLjUiIGhlaWdodD0iMS4yNSIvPjxyZWN0IGNsYXNzPSJjbHMtMiIgeD0iMzAuNzUiIHk9IjE4LjI1IiB3aWR0aD0iMi41IiBoZWlnaHQ9IjEuMjUiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0zMiwzMkgxN2ExLjI1LDEuMjUsMCwwLDEtMS4yNS0xLjI1VjI3QTEuMjUsMS4yNSwwLDAsMSwxNywyNS43NUgzMkExLjI1LDEuMjUsMCwwLDEsMzMuMjUsMjd2My43NUExLjI1LDEuMjUsMCwwLDEsMzIsMzJaTTE3LDI3djMuNzVIMzJWMjdaIi8+PHJlY3QgY2xhc3M9ImNscy0zIiB4PSIxNC41IiB5PSIxNC41IiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiLz48cmVjdCBjbGFzcz0iY2xzLTIiIHg9IjE1Ljc1IiB5PSIyMiIgd2lkdGg9IjE3LjUiIGhlaWdodD0iMS4yNSIvPjwvc3ZnPg==;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;spacingTop=-7;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;"
}
func (data *drawioData) NITextStyle() string {
	return "ellipse;whiteSpace=wrap;html=1;aspect=fixed;labelBorderColor=none;horizontal=1;resizable=0;rotatable=0;expand=0;fillColor=none;strokeColor=none;fontColor=#4277BB;fontSize=12;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;"
}
func (data *drawioData) Style(tn TreeNodeInterface) string {
	switch {
	case tn.IsVSI():
		return data.VsiStyle()
	case tn.IsNI():
		return "ellipse;whiteSpace=wrap;html=1;aspect=fixed;labelBorderColor=none;horizontal=1;resizable=0;rotatable=0;expand=0;fillColor=#FF8000;strokeColor=none;fontColor=#FFFFFF;fontSize=27;fontFamily=Times New Roman;"
	case tn.IsUser():
		return "shape=image;aspect=fixed;image=data:image/svg+xml,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OSA0OSI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOm5vbmU7fS5jbHMtMntmaWxsOiNmZmY7ZmlsbC1ydWxlOmV2ZW5vZGQ7fTwvc3R5bGU+PC9kZWZzPjxyZWN0IHg9IjAuNSIgeT0iMC41IiB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHJ4PSIyNCIvPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iMTQuNSIgeT0iMTQuNSIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIi8+PHBhdGggaWQ9IkZpbGwtMyIgY2xhc3M9ImNscy0yIiBkPSJNMzAuOCwzMy44N0gyOVYyOS41OUEyLjYzLDIuNjMsMCwwLDAsMjYuMywyN0gyMi43QTIuNjMsMi42MywwLDAsMCwyMCwyOS41OXY0LjI4SDE4LjJWMjkuNTlhNC40MSw0LjQxLDAsMCwxLDQuNS00LjI4aDMuNmE0LjQxLDQuNDEsMCwwLDEsNC41LDQuMjhaIi8+PHBhdGggaWQ9IkZpbGwtNSIgY2xhc3M9ImNscy0yIiBkPSJNMjQuNSwxNS4wNUE0LjM5LDQuMzksMCwwLDAsMjAsMTkuMzNhNC41MSw0LjUxLDAsMCwwLDksMCw0LjM5LDQuMzksMCwwLDAtNC41LTQuMjhtMCwxLjcxYTIuNTcsMi41NywwLDEsMS0yLjcsMi41NywyLjY0LDIuNjQsMCwwLDEsMi43LTIuNTciLz48L3N2Zz4=;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;spacingTop=-7;"
	case tn.IsGateway():
		return "shape=image;aspect=fixed;image=data:image/svg+xml,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OSA0OSI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMxMTkyZTg7fS5jbHMtMntmaWxsOiNmZmY7fS5jbHMtM3tmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgcng9IjgiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0zMy41MSwyNS4zOGExLjIzLDEuMjMsMCwwLDAsMC0xLjc2TDI5Ljg5LDIwbDEuODEtMS43OWExLjI1LDEuMjUsMCwxLDAtLjU4LTIuMDksMS4yMiwxLjIyLDAsMCwwLS4zMiwxLjIyTDI5LDE5LjEybC0zLjYzLTMuNjNhMS4yMywxLjIzLDAsMCwwLTEuNzYsMEwyMCwxOS4xMWwtMS43OS0xLjgyYTEuMjQsMS4yNCwwLDEsMC0yLjA5LjU5LDEuMjIsMS4yMiwwLDAsMCwxLjIyLjMyTDE5LjEyLDIwbC0zLjYzLDMuNjNhMS4yMywxLjIzLDAsMCwwLDAsMS43NkwxOS4xMiwyOSwxNy4zNCwzMC44YTEuMjIsMS4yMiwwLDAsMC0xLjIyLjMyLDEuMjQsMS4yNCwwLDEsMCwyLjA5LjU5TDIwLDI5Ljg5bDMuNjIsMy42MmExLjIzLDEuMjMsMCwwLDAsMS43NiwwTDI5LDI5Ljg4bDEuNzksMS43OGExLjIyLDEuMjIsMCwwLDAsLjMyLDEuMjIsMS4yNCwxLjI0LDAsMSwwLC41OC0yLjA5TDI5Ljg5LDI5Wm0tOSw3LjI0TDE2LjM4LDI0LjVsOC4xMi04LjEyLDguMTIsOC4xMloiLz48cmVjdCBjbGFzcz0iY2xzLTMiIHg9IjE0LjUiIHk9IjE0LjUiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTI2LjM4LDIzLjI1SDIzLjI1VjIyYTEuMjUsMS4yNSwwLDAsMSwyLjUsMEgyN2EyLjUsMi41LDAsMCwwLTUsMHYxLjQyYTEuMjYsMS4yNiwwLDAsMC0uNjIsMS4wOHYzLjEyYTEuMjYsMS4yNiwwLDAsMCwxLjI0LDEuMjZoMy43NmExLjI2LDEuMjYsMCwwLDAsMS4yNC0xLjI2VjI0LjVBMS4yNSwxLjI1LDAsMCwwLDI2LjM4LDIzLjI1Wm0wLDQuMzdIMjIuNjJWMjQuNWgzLjc2WiIvPjwvc3ZnPg==;fontSize=14;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;spacingTop=-7;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;"
	case tn.IsInternet():
		return "shape=image;aspect=fixed;image=data:image/svg+xml,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OSA0OSI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMxMTkyZTg7fS5jbHMtMntmaWxsOiNmZmY7fS5jbHMtM3tmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgcng9IjgiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0yNC41LDE1Ljc1YTguNzUsOC43NSwwLDEsMCw4Ljc1LDguNzVBOC43NSw4Ljc1LDAsMCwwLDI0LjUsMTUuNzVaTTMyLDIzLjg4SDI4LjI1YTE1LjE5LDE1LjE5LDAsMCwwLTEuNzQtNi42QTcuNSw3LjUsMCwwLDEsMzIsMjMuODhaTTI0LjUsMzJoLS40MkExMy43MiwxMy43MiwwLDAsMSwyMiwyNS4xMmg1QTEzLjYzLDEzLjYzLDAsMCwxLDI0Ljk0LDMyWk0yMiwyMy44OEExMy42MywxMy42MywwLDAsMSwyNC4wNiwxN2EzLjkzLDMuOTMsMCwwLDEsLjg0LDBBMTMuNjQsMTMuNjQsMCwwLDEsMjcsMjMuODhabS40OC02LjZhMTUuMTgsMTUuMTgsMCwwLDAtMS43Myw2LjZIMTdhNy41LDcuNSwwLDAsMSw1LjQ5LTYuNlpNMTcsMjUuMTJoMy43NWExNS4yLDE1LjIsMCwwLDAsMS43Miw2LjZBNy41Miw3LjUyLDAsMCwxLDE3LDI1LjEyWm05LjQ4LDYuNmExNS4xOSwxNS4xOSwwLDAsMCwxLjc0LTYuNkgzMkE3LjUsNy41LDAsMCwxLDI2LjUxLDMxLjcyWiIvPjxyZWN0IGlkPSJfVHJhbnNwYXJlbnRfUmVjdGFuZ2xlXyIgZGF0YS1uYW1lPSIgVHJhbnNwYXJlbnQgUmVjdGFuZ2xlICIgY2xhc3M9ImNscy0zIiB4PSIxNC41IiB5PSIxNC41IiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiLz48L3N2Zz4=;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;spacingTop=-7;"
	case tn.IsInternetService():
		return "shape=image;aspect=fixed;image=data:image/svg+xml,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OSA0OSI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMxMTkyZTg7fS5jbHMtMntmaWxsOiNmZmY7fS5jbHMtM3tmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIvPjxwYXRoIGNsYXNzPSJjbHMtMiIgZD0iTTMxLjg3LDIwLjc1YTYuMjUsNi4yNSwwLDAsMC0xMi4yNi4wOCw0LjY4LDQuNjgsMCwwLDAsLjgzLDkuMjloLjk0VjI4Ljg3aC0uOTRBMy40MywzLjQzLDAsMCwxLDIwLjIsMjJsLjUyLDAsLjA2LS41MmE1LDUsMCwwLDEsOS44MS0uNzFaIi8+PHJlY3QgY2xhc3M9ImNscy0zIiB4PSIxNC41IiB5PSIxNC41IiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik0zMS4zNywyOS41YTEuODQsMS44NCwwLDAsMC0xLjIuNDVsLTIuNTYtMS41NGMwLS4wNSwwLS4xLDAtLjE2czAtLjExLDAtLjE2bDIuNTYtMS41NGExLjg2LDEuODYsMCwwLDAsMS4yLjQ1LDEuODgsMS44OCwwLDEsMC0xLjg3LTEuODgsMS40MiwxLjQyLDAsMCwwLDAsLjM2bC0yLjQ1LDEuNDZhMS44NiwxLjg2LDAsMCwwLTEuMzQtLjU3LDEuODgsMS44OCwwLDAsMCwwLDMuNzUsMS44NSwxLjg1LDAsMCwwLDEuMzQtLjU2TDI5LjU0LDMxYTEuNDUsMS40NSwwLDAsMCwwLC4zNSwxLjg4LDEuODgsMCwxLDAsMS44Ny0xLjg3Wm0wLTVhLjYzLjYzLDAsMSwxLS42Mi42MkEuNjMuNjMsMCwwLDEsMzEuMzcsMjQuNVptLTUuNjIsNC4zN2EuNjMuNjMsMCwwLDEtLjYzLS42Mi42NC42NCwwLDAsMSwuNjMtLjYzLjYzLjYzLDAsMCwxLC42Mi42M0EuNjIuNjIsMCwwLDEsMjUuNzUsMjguODdaTTMxLjM3LDMyYS42My42MywwLDEsMSwuNjMtLjYzQS42My42MywwLDAsMSwzMS4zNywzMloiLz48L3N2Zz4=;fontSize=14;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;spacingTop=-6;"
	case tn.IsEndpoint():
		return "shape=image;aspect=fixed;image=data:image/svg+xml,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OSA0OSI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMxMTkyZTg7fS5jbHMtMntmaWxsOiNmZmY7fS5jbHMtM3tmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJjbHMtMSIgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIvPjxwYXRoIGlkPSJ2cGNfZ3JhZGllbnRfYm90dG9tIiBkYXRhLW5hbWU9InZwYyBncmFkaWVudCBib3R0b20iIGNsYXNzPSJjbHMtMiIgZD0iTTI3LDMxLjM4SDE4Ljg4YTEuMjcsMS4yNywwLDAsMS0xLjI2LTEuMjVWMjJoMS4yNnY4LjEzSDI3WiIvPjxwYXRoIGlkPSJ2cGNfZ3JhZGllbnRfdG9wIiBkYXRhLW5hbWU9InZwYyBncmFkaWVudCB0b3AiIGNsYXNzPSJjbHMtMiIgZD0iTTMwLjEyLDI3aDEuMjZWMTguODhhMS4yNiwxLjI2LDAsMCwwLTEuMjYtMS4yNUgyMnYxLjI1aDguMTJaIi8+PHBhdGggaWQ9ImVuZHBvaW50cyIgY2xhc3M9ImNscy0yIiBkPSJNMjkuMTIsMjguMjVsLTIuNS0yLjVBMi4yNiwyLjI2LDAsMCwwLDI3LDI0LjUsMi41MSwyLjUxLDAsMCwwLDI0LjUsMjJhMi4xOSwyLjE5LDAsMCwwLTEuMjUuMzhsLTIuNS0yLjVWMTUuNzVoLTV2NWg0LjEzbDIuNSwyLjVBMi4yNiwyLjI2LDAsMCwwLDIyLDI0LjUsMi41MSwyLjUxLDAsMCwwLDI0LjUsMjdhMi4yNiwyLjI2LDAsMCwwLDEuMjUtLjM4bDIuNSwyLjV2NC4xM2g1di01Wk0xOS41LDE5LjVIMTdWMTdoMi41Wm01LDYuMjVhMS4yNSwxLjI1LDAsMSwxLDEuMjUtMS4yNUExLjI1LDEuMjUsMCwwLDEsMjQuNSwyNS43NVpNMzIsMzJIMjkuNVYyOS41SDMyWiIvPjxyZWN0IGNsYXNzPSJjbHMtMyIgeD0iMTQuNSIgeT0iMTQuNSIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIi8+PC9zdmc+;fontSize=14;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;spacingTop=-7;labelPosition=center;verticalLabelPosition=bottom;align=center;verticalAlign=top;"

	case tn.IsNetwork():
		return "rounded=0;whiteSpace=wrap;html=1;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;spacingBottom=-28;spacingTop=0;labelPosition=-100;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=9;spacing=0;expand=0;recursiveResize=0;spacingRight=0;container=1;collapsible=0;strokeColor=#1192E8;fillColor=none;"
	case tn.IsVPC():
		return "rounded=0;whiteSpace=wrap;html=1;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;spacingBottom=-28;spacingTop=0;labelPosition=-100;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=9;spacing=0;expand=0;recursiveResize=0;spacingRight=0;container=1;collapsible=0;strokeColor=#1192E8;fillColor=none;"
	case tn.IsZone():
		return "rounded=0;whiteSpace=wrap;html=1;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;spacingBottom=-28;spacingTop=0;labelPosition=-100;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=9;spacing=0;expand=0;recursiveResize=0;spacingRight=0;container=1;collapsible=0;strokeColor=#878d96;fillColor=none;"
	case tn.IsSubnet():
		return "rounded=0;whiteSpace=wrap;html=1;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;spacingBottom=-28;spacingTop=0;labelPosition=-100;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=9;spacing=0;expand=0;recursiveResize=0;spacingRight=0;container=1;collapsible=0;strokeColor=#1192E8;fillColor=none;"
	case tn.IsPartialSG():
		return "rounded=0;whiteSpace=wrap;html=1;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;fillColor=none;spacingBottom=-28;spacingTop=0;labelPosition=-100;verticalLabelPosition=top;align=center;verticalAlign=bottom;spacingLeft=9;spacing=0;expand=0;recursiveResize=0;spacingRight=0;container=1;collapsible=0;strokeColor=#FA4D56;strokeWidth=1;"
	}
	return ""
}

func (data *drawioData) TagStyle(tn TreeNodeInterface) string {
	switch {
	case tn.IsNetwork():
		return "shape=image;aspect=fixed;image=data:image/svg+xml,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjlweCIgaGVpZ2h0PSIyNnB4IiB2aWV3Qm94PSIwIDAgMjkgMjYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzICg3MjUyMCkgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+UHVibGljIE5ldHdvcmsgQmxhY2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iUHVibGljLU5ldHdvcmstQmxhY2siIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuOTAxMTA2LCAtMC4xNzQyMzMpIiBmaWxsPSIjMDAwMDAwIj4KICAgICAgICAgICAgPGcgaWQ9IkludGVybmV0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMS44Njc1NTksIDEwLjExMTEyMykiPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTkuOTQwMzIwMTEsMTQuMjczNTIwNyBDMTAuOTEwMDkwMywxMi40MzQ5NjI3IDExLjQ0ODI4NzQsMTAuMzk5NTE3MSAxMS41MTQyOTI3LDguMzIxNzYwMzkgTDE0Ljg5OTE4MDEsOC4zMjE3NjAzOSBDMTQuNjU3MTYwNywxMS4xNDg3MDU1IDEyLjY3NzU2NTcsMTMuNTI0ODk2NCA5Ljk0MDMyMDExLDE0LjI3MzUyMDcgTDkuOTQwMzIwMTEsMTQuMjczNTIwNyBaIE0xLjM4NzgzODAzLDguMzIxNzYwMzkgTDQuNzcyNzI1NCw4LjMyMTc2MDM5IEM0LjgzMTk2MDkyLDEwLjM5NzgyNDYgNS4zNjIyNTk5NSwxMi40MzMyNzAzIDYuMzI0MTMyMTEsMTQuMjczNTIwNyBDMy41OTU5MTI4OSwxMy41MTY5OTg0IDEuNjI3MDM2NzMsMTEuMTQzMDY0IDEuMzg3ODM4MDMsOC4zMjE3NjAzOSBMMS4zODc4MzgwMyw4LjMyMTc2MDM5IFogTTYuNDA2NDk3NywxLjU1MTk4NTY1IEM1LjQwMTc1MDMsMy40NzA2NTI2NSA0Ljg0NjYyODc3LDUuNTkyOTc3MDMgNC43ODM0NDQyMSw3Ljc1NzYxMjUgTDEuMjU0MTM0OTgsNy43NTc2MTI1IEMxLjUwNjg3MzIzLDQuODA5OTM5NzUgMy41NzA1MjYyMywyLjMzMjc2NjM0IDYuNDI0NTUwNDMsMS41NTE5ODU2NSBMNi40MDY0OTc3LDEuNTUxOTg1NjUgWiBNNS44NzI4MTM3OSw3LjE5MzQ2NDYgQzUuOTI5MjI4NTgsNC45OTYxMDg1NSA2LjU3MTc5MzAzLDIuODUzNDc0ODUgNy43MzQ1MDE4NCwwLjk4NzgzNzc2IEM3Ljk4NjExMTgsMC45NTk2MzAzNjUgOC4yMzk0MTQyMSwwLjk1OTYzMDM2NSA4LjQ5MDQ2MDAyLDAuOTg3ODM3NzYgQzkuNjY1NTgwMDksMi44NTAwODk5NiAxMC4zMTk5OTE2LDQuOTkyNzIzNjcgMTAuMzg1OTk2OSw3LjE5MzQ2NDYgTDUuODcyODEzNzksNy4xOTM0NjQ2IFogTTguMTI5NDA1MzcsMTQuNTI3Mzg3MiBDOC4wMDM2MDAzOSwxNC41MzU4NDk1IDcuODc3MjMxMjYsMTQuNTM1ODQ5NSA3Ljc1MTQyNjI4LDE0LjUyNzM4NzIgQzYuNTgyNTExODQsMTIuNjYzNDQyNiA1LjkzNDMwNTkxLDEwLjUyMDgwODkgNS44NzI4MTM3OSw4LjMyMTc2MDM5IEwxMC4zODU5OTY5LDguMzIxNzYwMzkgQzEwLjMzMDE0NjMsMTAuNTE5NjgwNiA5LjY4NzAxNzcxLDEyLjY2MjMxNDMgOC41MjQzMDg5LDE0LjUyNzM4NzIgQzguMzkyODYyNDQsMTQuNTM2NDEzNiA4LjI2MDg1MTgzLDE0LjUzNjQxMzYgOC4xMjk0MDUzNywxNC41MjczODcyIEw4LjEyOTQwNTM3LDE0LjUyNzM4NzIgWiBNMTQuODk5MTgwMSw3LjE5MzQ2NDYgTDExLjUxNDI5MjcsNy4xOTM0NjQ2IEMxMS40NDgyODc0LDUuMTE1NzA3OTEgMTAuOTEwMDkwMywzLjA4MDI2MjMgOS45NDAzMjAxMSwxLjI0MTcwNDMxIEMxMi42Nzc1NjU3LDEuOTkwMzI4NTcgMTQuNjU3MTYwNyw0LjM2NjUxOTUgMTQuODk5MTgwMSw3LjE5MzQ2NDYgTDE0Ljg5OTE4MDEsNy4xOTM0NjQ2IFogTTguMTI5NDA1MzcsMC4xMzcxMDI3MzQgQzMuNzY3NDEzODUsMC4xMzcxMDI3MzQgMC4yMzEzMzQ4NDIsMy42NzMxODE3NCAwLjIzMTMzNDg0Miw4LjAzNTE3MzI2IEMwLjIzMTMzNDg0MiwxMi4zOTcxNjQ4IDMuNzY3NDEzODUsMTUuOTMzMjQzOCA4LjEyOTQwNTM3LDE1LjkzMzI0MzggQzEyLjQ5MTM5NjksMTUuOTMzMjQzOCAxNi4wMjc0NzU5LDEyLjM5NzE2NDggMTYuMDI3NDc1OSw4LjAzNTE3MzI2IEMxNi4wMjc0NzU5LDMuNjczMTgxNzQgMTIuNDkxMzk2OSwwLjEzNzEwMjczNCA4LjEyOTQwNTM3LDAuMTM3MTAyNzM0IEw4LjEyOTQwNTM3LDAuMTM3MTAyNzM0IFoiIGlkPSJGaWxsLTEiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8ZyBpZD0iQ2xhc3NpYy1JbmZyYXN0cnVjdHVyZS1CbGFjay1Db3B5Ij4KICAgICAgICAgICAgICAgIDxnIGlkPSJHcm91cC02IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMC45OTg0MDApIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMDAwMDIxMiwyMi45OTgwNDIyIEw3LjczNzAyMTE4LDIyLjk5ODA0MjIgQzQuMTQ2MDIxMTgsMjIuOTk4MDQyMiAwLjg3OTAyMTE4MiwyMC41NzkwNDIyIDAuMTU5MDIxMTgyLDE3LjA2MTA0MjIgQy0wLjcxMjk3ODgxOCwxMi43OTQwNDIyIDIuMTAwMDIxMTgsOC44NTEwNDIyMiA2LjE3ODAyMTE4LDguMTIyMDQyMjIgQzcuMjE2MDIxMTgsMi42OTgwNDIyMiAxMi40NTUwMjEyLC0wLjg1Nzk1Nzc4MyAxNy44NzkwMjEyLDAuMTgwMDQyMjE3IEMyMi41OTEwMjEyLDEuMDgxMDQyMjIgMjUuOTk5MDIxMiw1LjIwMTA0MjIyIDI2LjAwMDAyMTIsOS45OTgwNDIyMiBMMjQuMDAwMDIxMiw5Ljk5ODA0MjIyIEMyNC4wMDEwMjEyLDUuMTAwMDQyMjIgMTkuNTk5MDIxMiwxLjIyOTA0MjIyIDE0LjUzNDAyMTIsMi4xMjgwNDIyMiBDMTAuOTk5MDIxMiwyLjc1NjA0MjIyIDguNDA2MDIxMTgsNS44MjYwNDIyMiA4LjAyMTAyMTE4LDkuMzk2MDQyMjIgTDcuOTU5MDIxMTgsOS45NjEwNDIyMiBMNy4zMTMwMjExOCwxMC4wMDUwNDIyIEM0Ljc0MDAyMTE4LDEwLjE3OTA0MjIgMi40NzcwMjExOCwxMi4wMjIwNDIyIDIuMDcwMDIxMTgsMTQuNTY5MDQyMiBDMS41MTIwMjExOCwxOC4wNTcwNDIyIDQuMTgyMDIxMTgsMjEuMDAzMDQyMiA3LjUwMDAyMTE4LDIwLjk5ODA0MjIgTDEyLjAwMDAyMTIsMjAuOTk4MDQyMiBMMTIuMDAwMDIxMiwyMi45OTgwNDIyIFoiIGlkPSJGaWxsLTQiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+;"
	case tn.IsVPC():
		return "shape=image;aspect=fixed;image=data:image/svg+xml,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzNweCIgaGVpZ2h0PSIyOHB4IiB2aWV3Qm94PSIwIDAgMzMgMjgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzICg3MjUyMCkgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+VlBDIEJsYWNrPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+CiAgICAgICAgPHBvbHlnb24gaWQ9InBhdGgtMSIgcG9pbnRzPSIwIDAuOTk4IDMyIDAuOTk4IDMyIDI0LjAwMDIgMCAyNC4wMDAyIj48L3BvbHlnb24+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iVlBDLUJsYWNrIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjQ0NDU3MCwgLTAuOTk5ODc1KSI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi4wMDEzLDI3LjAwMTggTDEyLjAwMTMsMjEuMDAxOCBMMjAuMDAxMywyMS4wMDE4IEwyMC4wMDIzLDI3LjAwMTggTDEyLjAwMTMsMjcuMDAxOCBaIE0xNC4wMDEzLDE2LjAwMTggQzE0LjAwMTMsMTQuODk3OCAxNC44OTczLDE0LjAwMTggMTYuMDAxMywxNC4wMDE4IEMxNy4xMDUzLDE0LjAwMTggMTguMDAxMywxNC44OTc4IDE4LjAwMTMsMTYuMDAxOCBMMTguMDAxMywxOS4wMDE4IEwxNC4wMDEzLDE5LjAwMTggTDE0LjAwMTMsMTYuMDAxOCBaIE0yMC4wMDEzLDE5LjAwMTggTDIwLjAwMTMsMTYuMDAxOCBDMjAuMDAxMywxMy43OTI4IDE4LjIxMDMsMTIuMDAxOCAxNi4wMDEzLDEyLjAwMTggQzEzLjc5MjMsMTIuMDAxOCAxMi4wMDEzLDEzLjc5MjggMTIuMDAxMywxNi4wMDE4IEwxMi4wMDEzLDE5LjAwMTggQzEwLjg5NzMsMTkuMDAyOCAxMC4wMDIzLDE5Ljg5NzggMTAuMDAxMywyMS4wMDE4IEwxMC4wMDEzLDI3LjAwMTggQzEwLjAwMjMsMjguMTA1OCAxMC44OTczLDI5LjAwMDggMTIuMDAxMywyOS4wMDE4IEwyMC4wMDEzLDI5LjAwMTggQzIxLjEwNTMsMjkuMDAwOCAyMi4wMDAzLDI4LjEwNTggMjIuMDAxMywyNy4wMDE4IEwyMi4wMDEzLDIxLjAwMTggQzIyLjAwMDMsMTkuODk3OCAyMS4xMDUzLDE5LjAwMjggMjAuMDAxMywxOS4wMDE4IEwyMC4wMDEzLDE5LjAwMTggWiIgaWQ9IkZpbGwtMSIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgogICAgICAgICAgICA8ZyBpZD0iR3JvdXAtNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDAuMDAxODAwKSI+CiAgICAgICAgICAgICAgICA8bWFzayBpZD0ibWFzay0yIiBmaWxsPSJ3aGl0ZSI+CiAgICAgICAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4KICAgICAgICAgICAgICAgIDwvbWFzaz4KICAgICAgICAgICAgICAgIDxnIGlkPSJDbGlwLTQiPjwvZz4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0yNS44MzA0LDkuMTE1MiBDMjUuMDU2NCw1LjA5NTIgMjEuOTExNCwxLjk1MzIgMTcuODkxNCwxLjE4MTIgQzEyLjQ2NzQsMC4xMzQyIDcuMjIxNCwzLjY4MTIgNi4xNzM0LDkuMTA1MiBDNi4xNzI0LDkuMTA4MiA2LjE3MTQsOS4xMTIyIDYuMTcxNCw5LjExNTIgQzIuMDk0NCw5Ljg1MDIgLTAuNjE1NiwxMy43NTIyIDAuMTIwNCwxNy44MzAyIEMwLjc2NDQsMjEuMzk3MiAzLjg2NzQsMjMuOTk1MiA3LjQ5MjQsMjQuMDAwMiBMOC4wMDE0LDI0LjAwMDIgTDguMDAxNCwyMi4wMDAyIEw3LjQ5NjQsMjIuMDAwMiBDNC40NTc0LDIxLjk5NjIgMS45OTc0LDE5LjUzMDIgMi4wMDE0LDE2LjQ5MTIgQzIuMDA0NCwxMy44MzIyIDMuOTEwNCwxMS41NTUyIDYuNTI3NCwxMS4wODMyIEw3Ljg3NTQsMTAuODM5MiBMOC4xMzU0LDkuNDkzMiBDOC45NzQ0LDUuMTQ5MiAxMy4xNzU0LDIuMzA4MiAxNy41MTk0LDMuMTQ3MiBDMjAuNzMyNCwzLjc2NzIgMjMuMjQ1NCw2LjI4MDIgMjMuODY2NCw5LjQ5MzIgTDI0LjEyNTQsMTAuODM5MiBMMjUuNDc0NCwxMS4wODMyIEMyOC40NjQ0LDExLjYyMjIgMzAuNDUxNCwxNC40ODQyIDI5LjkxMjQsMTcuNDc0MiBDMjkuNDQwNCwyMC4wOTAyIDI3LjE2NzQsMjEuOTk1MiAyNC41MDk0LDIyLjAwMDIgTDI0LjAwMTQsMjIuMDAwMiBMMjQuMDAxNCwyNC4wMDAyIEwyNC41MDk0LDI0LjAwMDIgQzI4LjY1MTQsMjMuOTk0MiAzMi4wMDY0LDIwLjYzMTIgMzIuMDAwNCwxNi40ODcyIEMzMS45OTQ0LDEyLjg2MjIgMjkuMzk3NCw5Ljc1OTIgMjUuODMwNCw5LjExNTIiIGlkPSJGaWxsLTMiIGZpbGw9IiMwMDAwMDAiIG1hc2s9InVybCgjbWFzay0yKSI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=;"
	case tn.IsZone():
		return "shape=image;aspect=fixed;image=data:image/svg+xml,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjlweCIgaGVpZ2h0PSIyNnB4IiB2aWV3Qm94PSIwIDAgMjkgMjYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzICg3MjUyMCkgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Wm9uZSBCbGFjazwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJab25lLUJsYWNrIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjEyNTAwMCwgMC4wMDAwMDApIiBmaWxsPSIjMDAwMDAwIj4KICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTMiPgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTI2LjAwMDEsMjQuMDAwMSBMMjEuMDAwMSwyNC4wMDAxIEwyMS4wMDAxLDIwLjAwMDEgTDIzLjAwMDEsMjAuMDAwMSBMMjMuMDAwMSwxOC4wMDAxIEwyMS4wMDAxLDE4LjAwMDEgTDIxLjAwMDEsMTYuMDAwMSBMMjMuMDAwMSwxNi4wMDAxIEwyMy4wMDAxLDE0LjAwMDEgTDIxLjAwMDEsMTQuMDAwMSBMMjEuMDAwMSwxMi4wMDAxIEwyMy4wMDAxLDEyLjAwMDEgTDIzLjAwMDEsMTAuMDAwMSBMMjEuMDAwMSwxMC4wMDAxIEwyMS4wMDAxLDguMDAwMSBMMjYuMDAwMSw4LjAwMDEgTDI2LjAwMDEsMjQuMDAwMSBaIE05LjAwMDEsMjQuMDAwMSBMMTkuMDAwMSwyNC4wMDAxIEwxOS4wMDAxLDIuMDAwMSBMOS4wMDAxLDIuMDAwMSBMOS4wMDAxLDI0LjAwMDEgWiBNMi4wMDAxLDI0LjAwMDEgTDIuMDAwMSw4LjAwMDEgTDcuMDAwMSw4LjAwMDEgTDcuMDAwMSwxMC4wMDAxIEw1LjAwMDEsMTAuMDAwMSBMNS4wMDAxLDEyLjAwMDEgTDcuMDAwMSwxMi4wMDAxIEw3LjAwMDEsMTQuMDAwMSBMNS4wMDAxLDE0LjAwMDEgTDUuMDAwMSwxNi4wMDAxIEw3LjAwMDEsMTYuMDAwMSBMNy4wMDAxLDE4LjAwMDEgTDUuMDAwMSwxOC4wMDAxIEw1LjAwMDEsMjAuMDAwMSBMNy4wMDAxLDIwLjAwMDEgTDcuMDAwMSwyNC4wMDAxIEwyLjAwMDEsMjQuMDAwMSBaIE0yNi4wMDAxLDYuMDAwMSBMMjEuMDAwMSw2LjAwMDEgTDIxLjAwMDEsMi4wMDAxIEMyMC45OTkxLDAuODk2MSAyMC4xMDQxLDAuMDAxMSAxOS4wMDAxLDAuMDAwMSBMOS4wMDAxLDAuMDAwMSBDNy44OTYxLDAuMDAxMSA3LjAwMTEsMC44OTYxIDcuMDAwMSwyLjAwMDEgTDcuMDAwMSw2LjAwMDEgTDIuMDAwMSw2LjAwMDEgQzAuODk2MSw2LjAwMTEgMC4wMDExLDYuODk2MSAwLjAwMDEsOC4wMDAxIEwwLjAwMDEsMjQuMDAwMSBDMC4wMDExLDI1LjEwNDEgMC44OTYxLDI1Ljk5OTEgMi4wMDAxLDI2LjAwMDEgTDI2LjAwMDEsMjYuMDAwMSBDMjcuMTA0MSwyNS45OTkxIDI3Ljk5OTEsMjUuMTA0MSAyOC4wMDAxLDI0LjAwMDEgTDI4LjAwMDEsOC4wMDAxIEMyNy45OTkxLDYuODk2MSAyNy4xMDQxLDYuMDAxMSAyNi4wMDAxLDYuMDAwMSBMMjYuMDAwMSw2LjAwMDEgWiIgaWQ9IkZpbGwtMSI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJGaWxsLTQiIHBvaW50cz0iMTIgNiAxNiA2IDE2IDQgMTIgNCI+PC9wb2x5Z29uPgogICAgICAgICAgICA8cG9seWdvbiBpZD0iRmlsbC02IiBwb2ludHM9IjEyIDEwIDE2IDEwIDE2IDggMTIgOCI+PC9wb2x5Z29uPgogICAgICAgICAgICA8cG9seWdvbiBpZD0iRmlsbC03IiBwb2ludHM9IjEyIDE0IDE2IDE0IDE2IDEyIDEyIDEyIj48L3BvbHlnb24+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=;"
	case tn.IsSubnet():
		return "shape=image;aspect=fixed;image=data:image/svg+xml,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjlweCIgaGVpZ2h0PSIyOXB4IiB2aWV3Qm94PSIwIDAgMjkgMjkiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzICg3MjUyMCkgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+SUJNIFN1Ym5ldCA6IEFDTCBCbGFjazwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJJQk0tU3VibmV0LTotQUNMLUJsYWNrIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjc1MDAwMCwgMC4wNzQ5NTkpIiBmaWxsPSIjMDAwMDAwIj4KICAgICAgICAgICAgPHBhdGggZD0iTTI0LjAxNjEsMjYuMjIyMSBDMjIuOTEyMSwyNi4yMjIxIDIyLjAxNjEsMjUuMzI2MSAyMi4wMTYxLDI0LjIyMjEgQzIyLjAxNjEsMjMuMTE4MSAyMi45MTIxLDIyLjIyMjEgMjQuMDE2MSwyMi4yMjIxIEMyNS4xMjAxLDIyLjIyMjEgMjYuMDE2MSwyMy4xMTgxIDI2LjAxNjEsMjQuMjIyMSBDMjYuMDEzMSwyNS4zMjUxIDI1LjExOTEsMjYuMjE5MSAyNC4wMTYxLDI2LjIyMjEgTTQuMDE2MSwyNi4yMjIxIEMyLjkxMjEsMjYuMjIyMSAyLjAxNjEsMjUuMzI2MSAyLjAxNjEsMjQuMjIyMSBDMi4wMTYxLDIzLjExODEgMi45MTIxLDIyLjIyMjEgNC4wMTYxLDIyLjIyMjEgQzUuMTIwMSwyMi4yMjIxIDYuMDE2MSwyMy4xMTgxIDYuMDE2MSwyNC4yMjIxIEM2LjAxMzEsMjUuMzI1MSA1LjExOTEsMjYuMjE5MSA0LjAxNjEsMjYuMjIyMSBNNC4wMTYxLDYuMjIyMSBDMi45MTIxLDYuMjIyMSAyLjAxNjEsNS4zMjYxIDIuMDE2MSw0LjIyMjEgQzIuMDE2MSwzLjExODEgMi45MTIxLDIuMjIyMSA0LjAxNjEsMi4yMjIxIEM1LjEyMDEsMi4yMjIxIDYuMDE2MSwzLjExODEgNi4wMTYxLDQuMjIyMSBDNi4wMTMxLDUuMzI1MSA1LjExOTEsNi4yMTkxIDQuMDE2MSw2LjIyMjEgTTI0LjAxNjEsMi4yMjIxIEMyNS4xMjAxLDIuMjIyMSAyNi4wMTYxLDMuMTE4MSAyNi4wMTYxLDQuMjIyMSBDMjYuMDE2MSw1LjMyNjEgMjUuMTIwMSw2LjIyMjEgMjQuMDE2MSw2LjIyMjEgQzIyLjkxMjEsNi4yMjIxIDIyLjAxNjEsNS4zMjYxIDIyLjAxNjEsNC4yMjIxIEMyMi4wMTkxLDMuMTE4MSAyMi45MTMxLDIuMjI1MSAyNC4wMTYxLDIuMjIyMSBNMjQuMDE2MSwyMC4wMDAxIEMyMy4zMDUxLDE5Ljk5ODEgMjIuNjA5MSwyMC4yMDcxIDIyLjAxNjEsMjAuNjAwMSBMMTcuNDMwMSwxNi4wMDAxIEwxNi4wMTYxLDE3LjQxNDEgTDIwLjYxNjEsMjIuMDAwMSBDMjAuNDQwMSwyMi4zMTQxIDIwLjMwNjEsMjIuNjUxMSAyMC4yMTYxLDIzLjAwMDEgTDcuODc0MSwyMy4wMDAxIEM3Ljc3NDEsMjIuNjQ1MSA3LjYyMDEsMjIuMzA3MSA3LjQxNjEsMjIuMDAwMSBMMjIuMDE2MSw3LjQwMDEgQzIzLjgwNzEsOC41ODYxIDI2LjUzNzEsOC4wOTQxIDI3Ljc5NDEsNS4xOTgxIEMyNy45MTAxLDQuOTMyMSAyNy45OTIxLDQuNjQ0MSAyOC4wMTYxLDQuMzU1MSBDMjguMjIxMSwxLjk5NDEgMjYuMzcwMSwwLjAwOTEgMjQuMDQ4MSwwLjAwMDEgQzIyLjIxODEsLTAuMDA2OSAyMC42MTcxLDEuMjI4MSAyMC4xNTkxLDMuMDAwMSBMNy45MTYxLDMuMDAwMSBDNy40MzMxLDEuMjQwMSA1Ljg0MTEsMC4wMTUxIDQuMDE2MSwwLjAwMDEgQzEuNjc0MSwwLjAwMDEgLTAuMTk2OSwyLjAxMjEgMC4wMzYxLDQuNDAyMSBDMC4wNjcxLDQuNzIzMSAwLjE2MzEsNS4wNDExIDAuMjk5MSw1LjMzNTEgQzEuNTgyMSw4LjEwOTEgNC4yNTQxLDguNTY3MSA2LjAxNjEsNy40MDAxIEwxMC42MDIxLDEyLjAwMDEgTDEyLjAxNjEsMTAuNTg2MSBMNy40MTYxLDYuMDAwMSBDNy41OTIxLDUuNjg1MSA3LjcyNjEsNS4zNDkxIDcuODE2MSw1LjAwMDEgTDIwLjE1ODEsNS4wMDAxIEMyMC4yNTgxLDUuMzU1MSAyMC40MTIxLDUuNjkyMSAyMC42MTYxLDYuMDAwMSBMNi4wMTYxLDIwLjYwMDEgQzQuMjI0MSwxOS40MTMxIDEuNDk0MSwxOS45MDcxIDAuMjM3MSwyMi44MDUxIEMwLjEyMjEsMjMuMDcwMSAwLjA0MDEsMjMuMzU3MSAwLjAxNjEsMjMuNjQ1MSBDLTAuMTg3OSwyNi4wMDYxIDEuNjYzMSwyNy45OTExIDMuOTg0MSwyOC4wMDAxIEM1LjgxNDEsMjguMDA3MSA3LjQxNTEsMjYuNzcyMSA3Ljg3MzEsMjUuMDAwMSBMMjAuMTE2MSwyNS4wMDAxIEMyMC43MjkxLDI3LjQxMzEgMjMuNDEyMSwyOC43NTUxIDI1Ljc4NzEsMjcuNjEwMSBDMjcuMTAzMSwyNi45NzUxIDI3Ljk4NzEsMjUuNjA0MSAyOC4wMTgxLDI0LjE0MzEgQzI4LjA2ODEsMjEuNzk1MSAyNi4yMTIxLDIwLjAwNjEgMjQuMDE2MSwyMC4wMDAxIiBpZD0iRmlsbC0xIj48L3BhdGg+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=;"
	case tn.IsPartialSG():
		return "shape=image;aspect=fixed;image=data:image/svg+xml,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjhweCIgaGVpZ2h0PSIyOHB4IiB2aWV3Qm94PSIwIDAgMjggMjgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzICg3MjUyMCkgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+U2VjdXJpdHkgR3JvdXAgQmxhY2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz4KICAgICAgICA8cG9seWdvbiBpZD0icGF0aC0xIiBwb2ludHM9IjAgMC4wMDA0IDI0IDAuMDAwNCAyNCAyOCAwIDI4Ij48L3BvbHlnb24+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iU2VjdXJpdHktR3JvdXAtQmxhY2siPgogICAgICAgICAgICA8cGF0aCBkPSJNOSwxOSBMNywxOSBMNywxNyBDNy4wMDIsMTUuMzQ0IDguMzQ0LDE0LjAwMiAxMCwxNCBMMTYsMTQgTDE2LDE2IEwxMCwxNiBDOS40NDgsMTYgOS4wMDEsMTYuNDQ4IDksMTcgTDksMTkgWiIgaWQ9IkZpbGwtMSIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMTMsNyBDMTEuODk2LDcgMTEsNy44OTYgMTEsOSBDMTEsMTAuMTA0IDExLjg5NiwxMSAxMywxMSBDMTQuMTA0LDExIDE1LDEwLjEwNCAxNSw5IEMxNC45OTksNy44OTYgMTQuMTA0LDcuMDAxIDEzLDcgTTEzLDEzIEMxMC43OTEsMTMgOSwxMS4yMDkgOSw5IEM5LDYuNzkxIDEwLjc5MSw1IDEzLDUgQzE1LjIwOSw1IDE3LDYuNzkxIDE3LDkgQzE2Ljk5NywxMS4yMDggMTUuMjA4LDEyLjk5OCAxMywxMyIgaWQ9IkZpbGwtMyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMjIsMTQgQzIwLjg5NiwxNCAyMCwxNC44OTYgMjAsMTYgQzIwLDE3LjEwNCAyMC44OTYsMTggMjIsMTggQzIzLjEwNCwxOCAyNCwxNy4xMDQgMjQsMTYgQzIzLjk5OSwxNC44OTYgMjMuMTA0LDE0LjAwMSAyMiwxNCBNMjIsMjAgQzE5Ljc5MSwyMCAxOCwxOC4yMDkgMTgsMTYgQzE4LDEzLjc5MSAxOS43OTEsMTIgMjIsMTIgQzI0LjIwOSwxMiAyNiwxMy43OTEgMjYsMTYgQzI1Ljk5NywxOC4yMDggMjQuMjA4LDE5Ljk5OCAyMiwyMCIgaWQ9IkZpbGwtNSIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMjgsMjYgTDI2LDI2IEwyNiwyNCBDMjUuOTk5LDIzLjQ0OCAyNS41NTIsMjMgMjUsMjMgTDE5LDIzIEMxOC40NDgsMjMgMTguMDAxLDIzLjQ0OCAxOCwyNCBMMTgsMjYgTDE2LDI2IEwxNiwyNCBDMTYuMDAyLDIyLjM0NCAxNy4zNDQsMjEuMDAyIDE5LDIxIEwyNSwyMSBDMjYuNjU2LDIxLjAwMiAyNy45OTgsMjIuMzQ0IDI4LDI0IEwyOCwyNiBaIiBpZD0iRmlsbC03IiBmaWxsPSIjMDAwMDAwIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0xMSI+CiAgICAgICAgICAgICAgICA8bWFzayBpZD0ibWFzay0yIiBmaWxsPSJ3aGl0ZSI+CiAgICAgICAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4KICAgICAgICAgICAgICAgIDwvbWFzaz4KICAgICAgICAgICAgICAgIDxnIGlkPSJDbGlwLTEwIj48L2c+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIsMjUuNzMzNCBMNi43NjYsMjIuOTQyNCBDMy44MywyMS4zODA0IDEuOTk2LDE4LjMyNTQgMiwxNS4wMDA0IEwyLDIuMDAwNCBMMjIsMi4wMDA0IEwyMiw4LjAwMDQgTDI0LDguMDAwNCBMMjQsMi4wMDA0IEMyMy45OTksMC44OTY0IDIzLjEwNCwwLjAwMTQgMjIsMC4wMDA0IEwyLDAuMDAwNCBDMC44OTYsMC4wMDE0IDAuMDAxLDAuODk2NCAwLDIuMDAwNCBMMCwxNS4wMDA0IEMtMC4wMDUsMTkuMDY0NCAyLjIzNiwyMi43OTg0IDUuODI0LDI0LjcwNzQgTDEyLDI4LjAwMDQgTDEyLDI1LjczMzQgWiIgaWQ9IkZpbGwtOSIgZmlsbD0iIzAwMDAwMCIgbWFzaz0idXJsKCNtYXNrLTIpIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==;"
	}
	return ""
}

func (data *drawioData) TextStyle(tn TreeNodeInterface) string {
	switch {
	case tn.IsNetwork():
		return "text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;"
	case tn.IsVPC():
		return "text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;"
	case tn.IsZone():
		return "text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;"
	case tn.IsSubnet():
		return "text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;"
	case tn.IsPartialSG():
		return "text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontFamily=IBM Plex Sans;fontSource=fonts%2FIBMPlexSans-Regular.woff;fontSize=14;"
	}
	return ""
}

func (data *drawioData) DecoreStyle(tn TreeNodeInterface) string {
	switch {
	case tn.IsNetwork():
		return "rounded=0;whiteSpace=wrap;html=1;strokeColor=none;fillColor=#1192E8;"
	case tn.IsVPC():
		return "rounded=0;whiteSpace=wrap;html=1;strokeColor=none;fillColor=#1192E8;"
	case tn.IsZone():
		return "rounded=0;whiteSpace=wrap;html=1;strokeColor=none;fillColor=#878d96;"
	case tn.IsSubnet():
		return "rounded=0;whiteSpace=wrap;html=1;strokeColor=none;fillColor=#1192E8;"
	case tn.IsPartialSG():
		return "rounded=0;whiteSpace=wrap;html=1;strokeColor=none;fillColor=#FA4D56;"
	}
	return ""
}

func (data *drawioData) DecoreID(tn TreeNodeInterface) uint {
	return tn.ID() + 5
}

func CreateDrawioConnectivityMapFile(network SquareTreeNodeInterface, outputFile string) error {
	newLayout(network).layout()
	data := &drawioData{
		iconSize,
		fipXOffset,
		fipYOffset,
		vsiXOffset,
		vsiYOffset,
		vsiIconSize,
		hasVsiIcon(network),
		getAllNodes(network)}
	return writeDrawioFile(data, outputFile)
}

func writeDrawioFile(data *drawioData, outputFile string) error {
	tmpl, err := template.New("connectivityMap.drawio.tmpl").Parse(drawioTemplate)
	if err != nil {
		return err
	}
	fo, err := os.Create(outputFile)
	if err != nil {
		return err
	}
	// close fo on exit and check for its returned error
	defer func() {
		if closeErr := fo.Close(); closeErr != nil {
			fmt.Println("Error when closing:", closeErr)
		}
	}()
	err = tmpl.Execute(fo, data)
	if err != nil {
		return err
	}
	return nil
}
